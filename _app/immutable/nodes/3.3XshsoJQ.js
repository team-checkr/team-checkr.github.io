const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BEZz23-l.js","../chunks/DavXbj_w.js","../chunks/DGgHjv66.js","../chunks/D6-XlEtG.js"])))=>i.map(i=>d[i]);
import{_ as N}from"../chunks/DavXbj_w.js";import{n as q,a as y,t as R,c as H}from"../chunks/CQGBydWg.js";import{D as W,a3 as X,a4 as tt,T as J,a1 as et,a5 as b,a6 as $,a as C,u as rt,Q as j,a7 as at,a2 as st,g as e,a8 as f,b as nt,$ as it,R as M,S as E,P as I,a9 as F}from"../chunks/DGgHjv66.js";import{h as ot,s as ft}from"../chunks/W2uRDdWD.js";import{i as G}from"../chunks/CrP6Mcqk.js";import{a as lt,b as ct}from"../chunks/BmyH6ysu.js";import{E as ut}from"../chunks/CyO7aZKp.js";import{N as mt}from"../chunks/DKg0ri7i.js";import{r as pt}from"../chunks/CxD82Lhf.js";const dt=[];function _t(t,s=!1){return A(t,new Map,"",dt)}function A(t,s,m,o,n=null){if(typeof t=="object"&&t!==null){var p=s.get(t);if(p!==void 0)return p;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(W(t)){var a=Array(t.length);s.set(t,a),n!==null&&s.set(n,a);for(var i=0;i<t.length;i+=1){var u=t[i];i in t&&(a[i]=A(u,s,m,o))}return a}if(X(t)===tt){a={},s.set(t,a),n!==null&&s.set(n,a);for(var g in t)a[g]=A(t[g],s,m,o);return a}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function")return A(t.toJSON(),s,m,o,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}var gt=q('<svg><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12.75L11.25 15L15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.75 3.75 0 0 1-1.043 3.296a3.75 3.75 0 0 1-3.296 1.043A3.75 3.75 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.75 3.75 0 0 1-3.296-1.043a3.75 3.75 0 0 1-1.043-3.296A3.75 3.75 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.75 3.75 0 0 1 1.043-3.296a3.75 3.75 0 0 1 3.296-1.043A3.75 3.75 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.75 3.75 0 0 1 3.296 1.043a3.75 3.75 0 0 1 1.043 3.296A3.75 3.75 0 0 1 21 12"></path></svg>');function vt(t,s){const m=pt(s,["$$slots","$$events","$$legacy"]);var o=gt();let n;J(()=>n=lt(o,n,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...m})),y(t,o)}var ht=R('<meta name="description" content="Chip">'),bt=R("The program is <b>fully annotated</b>",1),yt=R("The program is <b><i>not</i> fully annotated</b>",1),xt=R('<!> <div class="relative grid grid-rows-[2fr_auto_auto] overflow-hidden bg-slate-800"><!> <div><span class="font-bold"> </span> <div class="flex-1"></div> <span class="text-xl"><!></span></div></div>',1);function Ct(t,s){et(s,!0);const m=`{ true }
if
  false -> skip
fi
{ true }`,o="chip-program";let n=b($((typeof localStorage.getItem(o)=="string"?localStorage.getItem(o):null)||m));C(()=>{localStorage.setItem(o,e(n))});let p=b($({parse_error:!1,prelude:"",assertions:[],markers:[],is_fully_annotated:!1})),a=b($([])),i=b(!1),u=b("idle"),g=b(null);rt(()=>{(async()=>{const{default:l,parse:k}=await N(async()=>{const{default:v,parse:x}=await import("../chunks/SU1yMK8Y.js");return{default:v,parse:x}},[],import.meta.url);await l(),f(g,k,!0)})().catch(console.error)}),C(()=>{if(!e(g))return;f(i,!1);const r=e(g)(e(n));r.parse_error&&f(i,!0),f(p,r,!0)});let w=0;C(()=>{const r=_t(e(p));let l=()=>{};return(async()=>{const v=++w,x=await N(()=>import("../chunks/BEZz23-l.js"),__vite__mapDeps([0,1,2,3]),import.meta.url);f(a,[],!0),f(u,"verifying");let c=!1,d=!1;for(const _ of r.assertions){const{cancel:U,result:Y}=x.run(_.smt,{prelude:r.prelude});l=U;const h=await Y;if(h=="cancelled")return;d||(d=h[h.length-1].trim()==="timeout");const Z=h[h.length-1].trim()==="unsat";if(v!==w){console.info("aborted",v,w,r,h);return}(!Z||d)&&(c=!0,f(a,[...nt(()=>e(a)),{severity:"Error",tags:[],message:_.text?_.text:"Verification failed",span:_.span,relatedInformation:[]},..._.related?[{severity:"Info",tags:[],message:_.related[0],span:_.related[1],relatedInformation:[]}]:[]],!0))}c?f(u,d?"timeout":"error",!0):f(u,"verified")})().catch(console.error),()=>{l()}});var T=xt();ot(r=>{var l=ht();it.title="Chip",y(r,l)});var V=j(T);mt(V,{title:"Chip",Icon:vt});var O=M(V,2),D=E(O);const z=at(()=>[...e(p).markers,...e(a)]);ut(D,{get markers(){return e(z)},get value(){return e(n)},set value(r){f(n,r,!0)}});var P=M(D,2),S=E(P),B=E(S,!0);I(S);var L=M(S,4),K=E(L);{var Q=r=>{var l=H(),k=j(l);{var v=c=>{var d=bt();F(),y(c,d)},x=c=>{var d=yt();F(),y(c,d)};G(k,c=>{e(p).is_fully_annotated?c(v):c(x,!1)})}y(r,l)};G(K,r=>{!e(i)&&e(u)=="verified"&&r(Q)})}I(L),I(P),I(O),J(()=>{ct(P,1,`flex items-center p-2 text-2xl text-white transition duration-500 ${(e(i)?"bg-purple-600":{idle:"bg-gray-500",verifying:"bg-yellow-500",verified:"bg-green-500",error:"bg-red-500",timeout:"bg-blue-500"}[e(u)])??""}`),ft(B,e(i)?"Parse error":{idle:"Idle",verifying:"Verifying...",verified:"Verified",error:"Verification error",timeout:"Verification timed out"}[e(u)])}),y(t,T),st()}export{Ct as component};
